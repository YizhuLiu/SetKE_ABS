Warning: METEOR is not configured
loading checkpoint ckpt-2.633675-87000...
loading checkpoint ckpt-3.242142-24000...
loading checkpoint ckpt-2.633675-87000...
start training with the following hyper-parameters:
{'net': 'rnn-ext_abs_rl', 'net_args': {'abstractor': {'net': 'base_abstractor', 'net_args': {'vocab_size': 30004, 'emb_dim': 128, 'n_hidden': 256, 'bidirectional': True, 'n_layer': 1}, 'traing_params': {'optimizer': ['adam', {'lr': 0.001}], 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5}}, 'extractor': {'net': 'ml_rnn_extractor', 'net_args': {'vocab_size': 30004, 'emb_dim': 128, 'conv_hidden': 100, 'lstm_hidden': 256, 'lstm_layer': 1, 'bidirectional': True}, 'traing_params': {'optimizer': ['adam', {'lr': 0.001}], 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5}}}, 'train_params': {'optimizer': ('adam', {'lr': 0.0001}), 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5, 'gamma': 0.95, 'reward': 'rouge-l', 'stop_coeff': 1.0, 'stop_reward': 'rouge-1'}}
Start training
/home/yizhu/anaconda3/envs/py3.7-pytorch1.2/lib/python3.7/site-packages/torch/nn/functional.py:1339: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
[0.0, 0.0, [0.2222222222222222, 0.14285714285714285, 0.0625, 0.4444444444444444], 0.07407407407407408, [0.0909090909090909, 0.13043478260869565, 0.13953488372093023, 0.15789473684210525], 0.025974025974025972, [0.052631578947368425, 0.06451612903225808, 0.12121212121212123, 0.1142857142857143], 0.972972972972973, 0.0, [0.052631578947368425, 0.13793103448275862, 0.1764705882352941, 0.12121212121212123], 0, 0, 0, 0, 0.3214285714285714]
[0.3214285714285714, 0, 0, 0, 0, [0.052631578947368425, 0.13793103448275862, 0.1764705882352941, 0.12121212121212123], 0.0, 0.972972972972973, [0.052631578947368425, 0.06451612903225808, 0.12121212121212123, 0.1142857142857143], 0.025974025974025972, [0.0909090909090909, 0.13043478260869565, 0.13953488372093023, 0.15789473684210525], 0.07407407407407408, [0.2222222222222222, 0.14285714285714285, 0.0625, 0.4444444444444444], 0.0, 0.0]
Traceback (most recent call last):
  File "train_full_rl_add.py", line 233, in <module>
    train(args)
  File "train_full_rl_add.py", line 187, in train
    trainer.train()
  File "/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/training.py", line 211, in train
    log_dict = self._pipeline.train_step()
  File "/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/rl_add.py", line 367, in train_step
    self._stop_reward_fn, self._stop_coeff
  File "/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/rl_add.py", line 262, in a2c_train_step
    R = r + gamma * R
TypeError: can only concatenate list (not "float") to list
