Warning: METEOR is not configured
loading checkpoint ckpt-2.633675-87000...
loading checkpoint ckpt-3.242142-24000...
loading checkpoint ckpt-2.633675-87000...
start training with the following hyper-parameters:
{'net': 'rnn-ext_abs_rl', 'net_args': {'abstractor': {'net': 'base_abstractor', 'net_args': {'vocab_size': 30004, 'emb_dim': 128, 'n_hidden': 256, 'bidirectional': True, 'n_layer': 1}, 'traing_params': {'optimizer': ['adam', {'lr': 0.001}], 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5}}, 'extractor': {'net': 'ml_rnn_extractor', 'net_args': {'vocab_size': 30004, 'emb_dim': 128, 'conv_hidden': 100, 'lstm_hidden': 256, 'lstm_layer': 1, 'bidirectional': True}, 'traing_params': {'optimizer': ['adam', {'lr': 0.001}], 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5}}}, 'train_params': {'optimizer': ('adam', {'lr': 0.0001}), 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5, 'gamma': 0.95, 'reward': 'rouge-l', 'stop_coeff': 1.0, 'stop_reward': 'rouge-1'}}
Start training
/home/yizhu/anaconda3/envs/py3.7-pytorch1.2/lib/python3.7/site-packages/torch/nn/functional.py:1339: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/model/rl_.py:86: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  softmax_score = F.softmax(score)
/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/model/rl_.py:124: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  softmax_score = F.softmax(score)
train step: 1, reward: 4.3016train step: 2, reward: 4.2965train step: 3, reward: 4.2911train step: 4, reward: 4.2945train step: 5, reward: 4.2853train step: 6, reward: 4.2811train step: 7, reward: 4.2800train step: 8, reward: 4.2783train step: 9, reward: 4.2775train step: 10, reward: 4.2727train step: 11, reward: 4.2674train step: 12, reward: 4.2608train step: 13, reward: 4.2548train step: 14, reward: 4.2506train step: 15, reward: 4.2443train step: 16, reward: 4.2352train step: 17, reward: 4.2359train step: 18, reward: 4.2263train step: 19, reward: 4.2199train step: 20, reward: 4.2122train step: 21, reward: 4.2084train step: 22, reward: 4.2126train step: 23, reward: 4.2156train step: 24, reward: 4.2083train step: 25, reward: 4.2023train step: 26, reward: 4.1996train step: 27, reward: 4.1968train step: 28, reward: 4.1989train step: 29, reward: 4.1937train step: 30, reward: 4.1859train step: 31, reward: 4.1791train step: 32, reward: 4.1745train step: 33, reward: 4.1687train step: 34, reward: 4.1685train step: 35, reward: 4.1678train step: 36, reward: 4.1640train step: 37, reward: 4.1547train step: 38, reward: 4.1467train step: 39, reward: 4.1446train step: 40, reward: 4.1486train step: 41, reward: 4.1463train step: 42, reward: 4.1422train step: 43, reward: 4.1402train step: 44, reward: 4.1290train step: 45, reward: 4.1227train step: 46, reward: 4.1194train step: 47, reward: 4.1174train step: 48, reward: 4.1142train step: 49, reward: 4.1070train step: 50, reward: 4.1029train step: 51, reward: 4.0975train step: 52, reward: 4.0955train step: 53, reward: 4.0867train step: 54, reward: 4.0854train step: 55, reward: 4.0804train step: 56, reward: 4.0785train step: 57, reward: 4.0764train step: 58, reward: 4.0752train step: 59, reward: 4.0712train step: 60, reward: 4.0767train step: 61, reward: 4.0766train step: 62, reward: 4.0706train step: 63, reward: 4.0681train step: 64, reward: 4.0657train step: 65, reward: 4.0592train step: 66, reward: 4.0567train step: 67, reward: 4.0508train step: 68, reward: 4.0527train step: 69, reward: 4.0490train step: 70, reward: 4.0483train step: 71, reward: 4.0397train step: 72, reward: 4.0343train step: 73, reward: 4.0287train step: 74, reward: 4.0313train step: 75, reward: 4.0332train step: 76, reward: 4.0331train step: 77, reward: 4.0304train step: 78, reward: 4.0227train step: 79, reward: 4.0222train step: 80, reward: 4.0229train step: 81, reward: 4.0226train step: 82, reward: 4.0214train step: 83, reward: 4.0178train step: 84, reward: 4.0146train step: 85, reward: 4.0111train step: 86, reward: 4.0115train step: 87, reward: 4.0113train step: 88, reward: 4.0019train step: 89, reward: 3.9972train step: 90, reward: 3.9971train step: 91, reward: 3.9886train step: 92, reward: 3.9926train step: 93, reward: 3.9977train step: 94, reward: 3.9963train step: 95, reward: 3.9933train step: 96, reward: 3.9875train step: 97, reward: 3.9871train step: 98, reward: 3.9863train step: 99, reward: 3.9864train step: 100, reward: 3.9809train step: 101, reward: 3.9839train step: 102, reward: 3.9867train step: 103, reward: 3.9804train step: 104, reward: 3.9801train step: 105, reward: 3.9712train step: 106, reward: 3.9713train step: 107, reward: 3.9722train step: 108, reward: 3.9635train step: 109, reward: 3.9576train step: 110, reward: 3.9604train step: 111, reward: 3.9612train step: 112, reward: 3.9573train step: 113, reward: 3.9476train step: 114, reward: 3.9431train step: 115, reward: 3.9369train step: 116, reward: 3.9283train step: 117, reward: 3.9278train step: 118, reward: 3.9258train step: 119, reward: 3.9221train step: 120, reward: 3.9166train step: 121, reward: 3.9129train step: 122, reward: 3.9090train step: 123, reward: 3.9060train step: 124, reward: 3.9070train step: 125, reward: 3.8983train step: 126, reward: 3.8930train step: 127, reward: 3.8940train step: 128, reward: 3.8912train step: 129, reward: 3.8857train step: 130, reward: 3.8823train step: 131, reward: 3.8788train step: 132, reward: 3.8749train step: 133, reward: 3.8741train step: 134, reward: 3.8772train step: 135, reward: 3.8778train step: 136, reward: 3.8793train step: 137, reward: 3.8811train step: 138, reward: 3.8732train step: 139, reward: 3.8761train step: 140, reward: 3.8715train step: 141, reward: 3.8686train step: 142, reward: 3.8678train step: 143, reward: 3.8619train step: 144, reward: 3.8624train step: 145, reward: 3.8651train step: 146, reward: 3.8637train step: 147, reward: 3.8574train step: 148, reward: 3.8599train step: 149, reward: 3.8560train step: 150, reward: 3.8555train step: 151, reward: 3.8601train step: 152, reward: 3.8610train step: 153, reward: 3.8597train step: 154, reward: 3.8573train step: 155, reward: 3.8568train step: 156, reward: 3.8581train step: 157, reward: 3.8563train step: 158, reward: 3.8512train step: 159, reward: 3.8474train step: 160, reward: 3.8458train step: 161, reward: 3.8378train step: 162, reward: 3.8400train step: 163, reward: 3.8375train step: 164, reward: 3.8398train step: 165, reward: 3.8342train step: 166, reward: 3.8314train step: 167, reward: 3.8262train step: 168, reward: 3.8217train step: 169, reward: 3.8145train step: 170, reward: 3.8135train step: 171, reward: 3.8132train step: 172, reward: 3.8115train step: 173, reward: 3.8114train step: 174, reward: 3.8096train step: 175, reward: 3.8083train step: 176, reward: 3.8046train step: 177, reward: 3.8075train step: 178, reward: 3.8084train step: 179, reward: 3.8062train step: 180, reward: 3.8020train step: 181, reward: 3.7948train step: 182, reward: 3.7954train step: 183, reward: 3.7942train step: 184, reward: 3.7902train step: 185, reward: 3.7912train step: 186, reward: 3.7883train step: 187, reward: 3.7878train step: 188, reward: 3.7835train step: 189, reward: 3.7884train step: 190, reward: 3.7910train step: 191, reward: 3.7928train step: 192, reward: 3.7986train step: 193, reward: 3.7942train step: 194, reward: 3.7915train step: 195, reward: 3.7961train step: 196, reward: 3.7957train step: 197, reward: 3.8037train step: 198, reward: 3.8059train step: 199, reward: 3.8137train step: 200, reward: 3.8094train step: 201, reward: 3.8022train step: 202, reward: 3.8108train step: 203, reward: 3.8102train step: 204, reward: 3.8066train step: 205, reward: 3.8041train step: 206, reward: 3.8022train step: 207, reward: 3.8008train step: 208, reward: 3.7970train step: 209, reward: 3.8000train step: 210, reward: 3.7973train step: 211, reward: 3.7994train step: 212, reward: 3.7981train step: 213, reward: 3.7990train step: 214, reward: 3.7974train step: 215, reward: 3.7944train step: 216, reward: 3.8001train step: 217, reward: 3.8029train step: 218, reward: 3.8026train step: 219, reward: 3.8025train step: 220, reward: 3.8015train step: 221, reward: 3.7941train step: 222, reward: 3.7937train step: 223, reward: 3.7951train step: 224, reward: 3.7944train step: 225, reward: 3.7763train step: 226, reward: 3.7712train step: 227, reward: 3.7746train step: 228, reward: 3.7780train step: 229, reward: 3.7835train step: 230, reward: 3.7863train step: 231, reward: 3.7828train step: 232, reward: 3.7810train step: 233, reward: 3.7728train step: 234, reward: 3.7753train step: 235, reward: 3.7780train step: 236, reward: 3.7808train step: 237, reward: 3.7797train step: 238, reward: 3.7787train step: 239, reward: 3.7734train step: 240, reward: 3.7713train step: 241, reward: 3.7677train step: 242, reward: 3.7671train step: 243, reward: 3.7693train step: 244, reward: 3.7674train step: 245, reward: 3.7622train step: 246, reward: 3.7508train step: 247, reward: 3.7493train step: 248, reward: 3.7497train step: 249, reward: 3.7476train step: 250, reward: 3.7494train step: 251, reward: 3.7513train step: 252, reward: 3.7519train step: 253, reward: 3.7583train step: 254, reward: 3.7614train step: 255, reward: 3.7676train step: 256, reward: 3.7637train step: 257, reward: 3.7638train step: 258, reward: 3.7632train step: 259, reward: 3.7669train step: 260, reward: 3.7695train step: 261, reward: 3.7679train step: 262, reward: 3.7673train step: 263, reward: 3.7692train step: 264, reward: 3.7749train step: 265, reward: 3.7718train step: 266, reward: 3.7737train step: 267, reward: 3.7807train step: 268, reward: 3.7806train step: 269, reward: 3.7783train step: 270, reward: 3.7779train step: 271, reward: 3.7781train step: 272, reward: 3.7695train step: 273, reward: 3.7691train step: 274, reward: 3.7711train step: 275, reward: 3.7689train step: 276, reward: 3.7673train step: 277, reward: 3.7612train step: 278, reward: 3.7595train step: 279, reward: 3.7565train step: 280, reward: 3.7530train step: 281, reward: 3.7559train step: 282, reward: 3.7539train step: 283, reward: 3.7519train step: 284, reward: 3.7478train step: 285, reward: 3.7432train step: 286, reward: 3.7390train step: 287, reward: 3.7387train step: 288, reward: 3.7394train step: 289, reward: 3.7408train step: 290, reward: 3.7399train step: 291, reward: 3.7334train step: 292, reward: 3.7342train step: 293, reward: 3.7333train step: 294, reward: 3.7358train step: 295, reward: 3.7328train step: 296, reward: 3.7292train step: 297, reward: 3.7350train step: 298, reward: 3.7354train step: 299, reward: 3.7316train step: 300, reward: 3.7318train step: 301, reward: 3.7287train step: 302, reward: 3.7318train step: 303, reward: 3.7324train step: 304, reward: 3.7371train step: 305, reward: 3.7390train step: 306, reward: 3.7353train step: 307, reward: 3.7239train step: 308, reward: 3.7263train step: 309, reward: 3.7286train step: 310, reward: 3.7277train step: 311, reward: 3.7314train step: 312, reward: 3.7319train step: 313, reward: 3.7336train step: 314, reward: 3.7352train step: 315, reward: 3.7305train step: 316, reward: 3.7343train step: 317, reward: 3.7407train step: 318, reward: 3.7354train step: 319, reward: 3.7375train step: 320, reward: 3.7331train step: 321, reward: 3.7326train step: 322, reward: 3.7398train step: 323, reward: 3.7371train step: 324, reward: 3.7323train step: 325, reward: 3.7312train step: 326, reward: 3.7241train step: 327, reward: 3.7236train step: 328, reward: 3.7273train step: 329, reward: 3.7268train step: 330, reward: 3.7296train step: 331, reward: 3.7340train step: 332, reward: 3.7369train step: 333, reward: 3.7360train step: 334, reward: 3.7296train step: 335, reward: 3.7330train step: 336, reward: 3.7345train step: 337, reward: 3.7373train step: 338, reward: 3.7386train step: 339, reward: 3.7423train step: 340, reward: 3.7415train step: 341, reward: 3.7400train step: 342, reward: 3.7430train step: 343, reward: 3.7417train step: 344, reward: 3.7430train step: 345, reward: 3.7433train step: 346, reward: 3.7404train step: 347, reward: 3.7406train step: 348, reward: 3.7413train step: 349, reward: 3.7443train step: 350, reward: 3.7389train step: 351, reward: 3.7371train step: 352, reward: 3.7370train step: 353, reward: 3.7337train step: 354, reward: 3.7321train step: 355, reward: 3.7279train step: 356, reward: 3.7251train step: 357, reward: 3.7265train step: 358, reward: 3.7268train step: 359, reward: 3.7277train step: 360, reward: 3.7268train step: 361, reward: 3.7279train step: 362, reward: 3.7362train step: 363, reward: 3.7346train step: 364, reward: 3.7364train step: 365, reward: 3.7409train step: 366, reward: 3.7423train step: 367, reward: 3.7398train step: 368, reward: 3.7440train step: 369, reward: 3.7433train step: 370, reward: 3.7418train step: 371, reward: 3.7384train step: 372, reward: 3.7278train step: 373, reward: 3.7270train step: 374, reward: 3.7308train step: 375, reward: 3.7285train step: 376, reward: 3.7306train step: 377, reward: 3.7272train step: 378, reward: 3.7358train step: 379, reward: 3.7364train step: 380, reward: 3.7373train step: 381, reward: 3.7395train step: 382, reward: 3.7366train step: 383, reward: 3.7336train step: 384, reward: 3.7324train step: 385, reward: 3.7324train step: 386, reward: 3.7313train step: 387, reward: 3.7258train step: 388, reward: 3.7320train step: 389, reward: 3.7332train step: 390, reward: 3.7390train step: 391, reward: 3.7388train step: 392, reward: 3.7365train step: 393, reward: 3.7349train step: 394, reward: 3.7317train step: 395, reward: 3.7294train step: 396, reward: 3.7257train step: 397, reward: 3.7309train step: 398, reward: 3.7318train step: 399, reward: 3.7321train step: 400, reward: 3.7269train step: 401, reward: 3.7293train step: 402, reward: 3.7349train step: 403, reward: 3.7380train step: 404, reward: 3.7430train step: 405, reward: 3.7408train step: 406, reward: 3.7412train step: 407, reward: 3.7429train step: 408, reward: 3.7429train step: 409, reward: 3.7490train step: 410, reward: 3.7533train step: 411, reward: 3.7503train step: 412, reward: 3.7555train step: 413, reward: 3.7566train step: 414, reward: 3.7620train step: 415, reward: 3.7670train step: 416, reward: 3.7620train step: 417, reward: 3.7587train step: 418, reward: 3.7633train step: 419, reward: 3.7617train step: 420, reward: 3.7668train step: 421, reward: 3.7575train step: 422, reward: 3.7540train step: 423, reward: 3.7559train step: 424, reward: 3.7514train step: 425, reward: 3.7505train step: 426, reward: 3.7497train step: 427, reward: 3.7457train step: 428, reward: 3.7388train step: 429, reward: 3.7447train step: 430, reward: 3.7383train step: 431, reward: 3.7345train step: 432, reward: 3.7348train step: 433, reward: 3.7339train step: 434, reward: 3.7304train step: 435, reward: 3.7346train step: 436, reward: 3.7377train step: 437, reward: 3.7360train step: 438, reward: 3.7299train step: 439, reward: 3.7285train step: 440, reward: 3.7345train step: 441, reward: 3.7382train step: 442, reward: 3.7352train step: 443, reward: 3.7383train step: 444, reward: 3.7402train step: 445, reward: 3.7377train step: 446, reward: 3.7363train step: 447, reward: 3.7395train step: 448, reward: 3.7316train step: 449, reward: 3.7342train step: 450, reward: 3.7327train step: 451, reward: 3.7310train step: 452, reward: 3.7314train step: 453, reward: 3.7302train step: 454, reward: 3.7360train step: 455, reward: 3.7343train step: 456, reward: 3.7339train step: 457, reward: 3.7347train step: 458, reward: 3.7370train step: 459, reward: 3.7366train step: 460, reward: 3.7354train step: 461, reward: 3.7341train step: 462, reward: 3.7423train step: 463, reward: 3.7389train step: 464, reward: 3.7368train step: 465, reward: 3.7378train step: 466, reward: 3.7360train step: 467, reward: 3.7346train step: 468, reward: 3.7344train step: 469, reward: 3.7408train step: 470, reward: 3.7363train step: 471, reward: 3.7341train step: 472, reward: 3.7330train step: 473, reward: 3.7339train step: 474, reward: 3.7378train step: 475, reward: 3.7403train step: 476, reward: 3.7438train step: 477, reward: 3.7460train step: 478, reward: 3.7473train step: 479, reward: 3.7449train step: 480, reward: 3.7413train step: 481, reward: 3.7444train step: 482, reward: 3.7426train step: 483, reward: 3.7452train step: 484, reward: 3.7417train step: 485, reward: 3.7370train step: 486, reward: 3.7174train step: 487, reward: 3.7242train step: 488, reward: 3.7311train step: 489, reward: 3.7316train step: 490, reward: 3.7376train step: 491, reward: 3.7358train step: 492, reward: 3.7352train step: 493, reward: 3.7396train step: 494, reward: 3.7416train step: 495, reward: 3.7454train step: 496, reward: 3.7465train step: 497, reward: 3.7487train step: 498, reward: 3.7515train step: 499, reward: 3.7586train step: 500, reward: 3.7588train step: 501, reward: 3.7607train step: 502, reward: 3.7619train step: 503, reward: 3.7557train step: 504, reward: 3.7536train step: 505, reward: 3.7541train step: 506, reward: 3.7545train step: 507, reward: 3.7565train step: 508, reward: 3.7579train step: 509, reward: 3.7587train step: 510, reward: 3.7641train step: 511, reward: 3.7648train step: 512, reward: 3.7716train step: 513, reward: 3.7714train step: 514, reward: 3.7717train step: 515, reward: 3.7712train step: 516, reward: 3.7742train step: 517, reward: 3.7677train step: 518, reward: 3.7657train step: 519, reward: 3.7684train step: 520, reward: 3.7654train step: 521, reward: 3.7673train step: 522, reward: 3.7679train step: 523, reward: 3.7652train step: 524, reward: 3.7650train step: 525, reward: 3.7650train step: 526, reward: 3.7603train step: 527, reward: 3.7584train step: 528, reward: 3.7556train step: 529, reward: 3.7510train step: 530, reward: 3.7519train step: 531, reward: 3.7535train step: 532, reward: 3.7594train step: 533, reward: 3.7637train step: 534, reward: 3.7681train step: 535, reward: 3.7637train step: 536, reward: 3.7658train step: 537, reward: 3.7629train step: 538, reward: 3.7613train step: 539, reward: 3.7630train step: 540, reward: 3.7595train step: 541, reward: 3.7595train step: 542, reward: 3.7585train step: 543, reward: 3.7586train step: 544, reward: 3.7573train step: 545, reward: 3.7518train step: 546, reward: 3.7613train step: 547, reward: 3.7566train step: 548, reward: 3.7552train step: 549, reward: 3.7590train step: 550, reward: 3.7580train step: 551, reward: 3.7597train step: 552, reward: 3.7552train step: 553, reward: 3.7603train step: 554, reward: 3.7627train step: 555, reward: 3.7592train step: 556, reward: 3.7652Traceback (most recent call last):
  File "train_full_rl_.py", line 234, in <module>
    train(args)
  File "train_full_rl_.py", line 187, in train
    trainer.train()
  File "/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/training.py", line 211, in train
    log_dict = self._pipeline.train_step()
  File "/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/rl_.py", line 79, in train_step
    self._stop_reward_fn, self._stop_coeff
  File "/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/rl_.py", line 279, in a2c_train_step
    advantage += (all_rewards[-1] - bs[-1])
IndexError: list index out of range
loading checkpoint ckpt-0-0...
Traceback (most recent call last):
  File "decode_full_model.py", line 191, in <module>
    args.max_dec_word, args.cuda)
  File "decode_full_model.py", line 43, in decode
    extractor = RLExtractor(model_dir, cuda=cuda)
  File "/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/decoding.py", line 192, in __init__
    ext_ckpt = load_best_ckpt(ext_dir, reverse=True)
  File "/home/yizhu/FastRL_F1_loss_reward/fast-abs-rl/decoding.py", line 49, in load_best_ckpt
    print('loading checkpoint {}...'.format(ckpts[0]))
IndexError: list index out of range
