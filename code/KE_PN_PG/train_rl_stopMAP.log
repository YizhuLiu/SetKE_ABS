Warning: METEOR is not configured
loading checkpoint ckpt-2.633675-87000...
loading checkpoint ckpt-3.242142-24000...
loading checkpoint ckpt-2.633675-87000...
start training with the following hyper-parameters:
{'net': 'rnn-ext_abs_rl', 'net_args': {'abstractor': {'net': 'base_abstractor', 'net_args': {'vocab_size': 30004, 'emb_dim': 128, 'n_hidden': 256, 'bidirectional': True, 'n_layer': 1}, 'traing_params': {'optimizer': ['adam', {'lr': 0.001}], 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5}}, 'extractor': {'net': 'ml_rnn_extractor', 'net_args': {'vocab_size': 30004, 'emb_dim': 128, 'conv_hidden': 100, 'lstm_hidden': 256, 'lstm_layer': 1, 'bidirectional': True}, 'traing_params': {'optimizer': ['adam', {'lr': 0.001}], 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5}}}, 'train_params': {'optimizer': ('adam', {'lr': 0.0001}), 'clip_grad_norm': 2.0, 'batch_size': 32, 'lr_decay': 0.5, 'gamma': 0.95, 'reward': 'rouge-l', 'stop_coeff': 1.0, 'stop_reward': 'rouge-1'}}
Start training
/home/yizhu/anaconda3/envs/py3.7-pytorch1.2/lib/python3.7/site-packages/torch/nn/functional.py:1339: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
WARNING: Exploding Gradients 53266.85
train step: 1, reward: 0.0434train step: 2, reward: 0.0434train step: 3, reward: 0.0434train step: 4, reward: 0.0434train step: 5, reward: 0.0434train step: 6, reward: 0.0435train step: 7, reward: 0.0437train step: 8, reward: 0.0437train step: 9, reward: 0.0438train step: 10, reward: 0.0438train step: 11, reward: 0.0439train step: 12, reward: 0.0439train step: 13, reward: 0.0438train step: 14, reward: 0.0438train step: 15, reward: 0.0439train step: 16, reward: 0.0440WARNING: Exploding Gradients 420.87
train step: 17, reward: 0.0440train step: 18, reward: 0.0441train step: 19, reward: 0.0441train step: 20, reward: 0.0441train step: 21, reward: 0.0442train step: 22, reward: 0.0442train step: 23, reward: 0.0442train step: 24, reward: 0.0442train step: 25, reward: 0.0444train step: 26, reward: 0.0445train step: 27, reward: 0.0446train step: 28, reward: 0.0446train step: 29, reward: 0.0446train step: 30, reward: 0.0447train step: 31, reward: 0.0448train step: 32, reward: 0.0449train step: 33, reward: 0.0449train step: 34, reward: 0.0450train step: 35, reward: 0.0451train step: 36, reward: 0.0451train step: 37, reward: 0.0450train step: 38, reward: 0.0451train step: 39, reward: 0.0452train step: 40, reward: 0.0453train step: 41, reward: 0.0454train step: 42, reward: 0.0454train step: 43, reward: 0.0455train step: 44, reward: 0.0455train step: 45, reward: 0.0456train step: 46, reward: 0.0456train step: 47, reward: 0.0457train step: 48, reward: 0.0457train step: 49, reward: 0.0458train step: 50, reward: 0.0458train step: 51, reward: 0.0460train step: 52, reward: 0.0460train step: 53, reward: 0.0460train step: 54, reward: 0.0459train step: 55, reward: 0.0460train step: 56, reward: 0.0460train step: 57, reward: 0.0460train step: 58, reward: 0.0461train step: 59, reward: 0.0463train step: 60, reward: 0.0463train step: 61, reward: 0.0463train step: 62, reward: 0.0464train step: 63, reward: 0.0464train step: 64, reward: 0.0463train step: 65, reward: 0.0464train step: 66, reward: 0.0464train step: 67, reward: 0.0464train step: 68, reward: 0.0464train step: 69, reward: 0.0465train step: 70, reward: 0.0466train step: 71, reward: 0.0467train step: 72, reward: 0.0466train step: 73, reward: 0.0465train step: 74, reward: 0.0466train step: 75, reward: 0.0466train step: 76, reward: 0.0466train step: 77, reward: 0.0467train step: 78, reward: 0.0467train step: 79, reward: 0.0467train step: 80, reward: 0.0469train step: 81, reward: 0.0470train step: 82, reward: 0.0469train step: 83, reward: 0.0471train step: 84, reward: 0.0471train step: 85, reward: 0.0471train step: 86, reward: 0.0472train step: 87, reward: 0.0472train step: 88, reward: 0.0472train step: 89, reward: 0.0472train step: 90, reward: 0.0474train step: 91, reward: 0.0475train step: 92, reward: 0.0476train step: 93, reward: 0.0476train step: 94, reward: 0.0476train step: 95, reward: 0.0476train step: 96, reward: 0.0478train step: 97, reward: 0.0478train step: 98, reward: 0.0478train step: 99, reward: 0.0479train step: 100, reward: 0.0481train step: 101, reward: 0.0481train step: 102, reward: 0.0481train step: 103, reward: 0.0481train step: 104, reward: 0.0480train step: 105, reward: 0.0481train step: 106, reward: 0.0480train step: 107, reward: 0.0481train step: 108, reward: 0.0482train step: 109, reward: 0.0482train step: 110, reward: 0.0483train step: 111, reward: 0.0483train step: 112, reward: 0.0485train step: 113, reward: 0.0485train step: 114, reward: 0.0485train step: 115, reward: 0.0485train step: 116, reward: 0.0485train step: 117, reward: 0.0486train step: 118, reward: 0.0486train step: 119, reward: 0.0486train step: 120, reward: 0.0488train step: 121, reward: 0.0488train step: 122, reward: 0.0489train step: 123, reward: 0.0489train step: 124, reward: 0.0489train step: 125, reward: 0.0491train step: 126, reward: 0.0491train step: 127, reward: 0.0491train step: 128, reward: 0.0491train step: 129, reward: 0.0491train step: 130, reward: 0.0492train step: 131, reward: 0.0493train step: 132, reward: 0.0494train step: 133, reward: 0.0494train step: 134, reward: 0.0494train step: 135, reward: 0.0495train step: 136, reward: 0.0496train step: 137, reward: 0.0497train step: 138, reward: 0.0498train step: 139, reward: 0.0499train step: 140, reward: 0.0499train step: 141, reward: 0.0500train step: 142, reward: 0.0500train step: 143, reward: 0.0501train step: 144, reward: 0.0501train step: 145, reward: 0.0499train step: 146, reward: 0.0500train step: 147, reward: 0.0501train step: 148, reward: 0.0501train step: 149, reward: 0.0501train step: 150, reward: 0.0502train step: 151, reward: 0.0502train step: 152, reward: 0.0504train step: 153, reward: 0.0505train step: 154, reward: 0.0505train step: 155, reward: 0.0505train step: 156, reward: 0.0504train step: 157, reward: 0.0503train step: 158, reward: 0.0504train step: 159, reward: 0.0506train step: 160, reward: 0.0506train step: 161, reward: 0.0506train step: 162, reward: 0.0506train step: 163, reward: 0.0507train step: 164, reward: 0.0507train step: 165, reward: 0.0507train step: 166, reward: 0.0509train step: 167, reward: 0.0509train step: 168, reward: 0.0509train step: 169, reward: 0.0510train step: 170, reward: 0.0510train step: 171, reward: 0.0510train step: 172, reward: 0.0511train step: 173, reward: 0.0513train step: 174, reward: 0.0513train step: 175, reward: 0.0515train step: 176, reward: 0.0516train step: 177, reward: 0.0515train step: 178, reward: 0.0516train step: 179, reward: 0.0516train step: 180, reward: 0.0515train step: 181, reward: 0.0515train step: 182, reward: 0.0516train step: 183, reward: 0.0516train step: 184, reward: 0.0517train step: 185, reward: 0.0518train step: 186, reward: 0.0519train step: 187, reward: 0.0521train step: 188, reward: 0.0521train step: 189, reward: 0.0522train step: 190, reward: 0.0522train step: 191, reward: 0.0523train step: 192, reward: 0.0524train step: 193, reward: 0.0524train step: 194, reward: 0.0524train step: 195, reward: 0.0525train step: 196, reward: 0.0525train step: 197, reward: 0.0524train step: 198, reward: 0.0523train step: 199, reward: 0.0525train step: 200, reward: 0.0525train step: 201, reward: 0.0525train step: 202, reward: 0.0525train step: 203, reward: 0.0526train step: 204, reward: 0.0526train step: 205, reward: 0.0526train step: 206, reward: 0.0527train step: 207, reward: 0.0528train step: 208, reward: 0.0527train step: 209, reward: 0.0527train step: 210, reward: 0.0527train step: 211, reward: 0.0529train step: 212, reward: 0.0530train step: 213, reward: 0.0530train step: 214, reward: 0.0532train step: 215, reward: 0.0532train step: 216, reward: 0.0531train step: 217, reward: 0.0531train step: 218, reward: 0.0532train step: 219, reward: 0.0533train step: 220, reward: 0.0533train step: 221, reward: 0.0532train step: 222, reward: 0.0532train step: 223, reward: 0.0533train step: 224, reward: 0.0532train step: 225, reward: 0.0531train step: 226, reward: 0.0531train step: 227, reward: 0.0532train step: 228, reward: 0.0532train step: 229, reward: 0.0533train step: 230, reward: 0.0533train step: 231, reward: 0.0533train step: 232, reward: 0.0534train step: 233, reward: 0.0533train step: 234, reward: 0.0534train step: 235, reward: 0.0534train step: 236, reward: 0.0535train step: 237, reward: 0.0535train step: 238, reward: 0.0536train step: 239, reward: 0.0536train step: 240, reward: 0.0536train step: 241, reward: 0.0536train step: 242, reward: 0.0537train step: 243, reward: 0.0538WARNING: Exploding Gradients 7297.75
train step: 244, reward: 0.0539WARNING: Exploding Gradients 170.15
train step: 245, reward: 0.0540WARNING: Exploding Gradients 150.80
train step: 246, reward: 0.0539WARNING: Exploding Gradients 216.43
train step: 247, reward: 0.0539train step: 248, reward: 0.0540train step: 249, reward: 0.0541WARNING: Exploding Gradients 503.34
train step: 250, reward: 0.0541train step: 251, reward: 0.0541WARNING: Exploding Gradients 416.34
train step: 252, reward: 0.0541train step: 253, reward: 0.0542WARNING: Exploding Gradients 1405.76
train step: 254, reward: 0.0542train step: 255, reward: 0.0543train step: 256, reward: 0.0543WARNING: Exploding Gradients 1428.13
train step: 257, reward: 0.0544train step: 258, reward: 0.0545WARNING: Exploding Gradients 353.26
train step: 259, reward: 0.0547WARNING: Exploding Gradients 15046.71
train step: 260, reward: 0.0546train step: 261, reward: 0.0545WARNING: Exploding Gradients 1032.42
train step: 262, reward: 0.0546train step: 263, reward: 0.0546train step: 264, reward: 0.0545train step: 265, reward: 0.0545WARNING: Exploding Gradients 880.38
train step: 266, reward: 0.0545WARNING: Exploding Gradients 216.98
train step: 267, reward: 0.0545train step: 268, reward: 0.0545train step: 269, reward: 0.0545train step: 270, reward: 0.0543train step: 271, reward: 0.0544WARNING: Exploding Gradients 1171.25
train step: 272, reward: 0.0543train step: 273, reward: 0.0544train step: 274, reward: 0.0544WARNING: Exploding Gradients 1739.43
train step: 275, reward: 0.0544WARNING: Exploding Gradients 106.38
train step: 276, reward: 0.0544train step: 277, reward: 0.0544train step: 278, reward: 0.0545train step: 279, reward: 0.0545train step: 280, reward: 0.0545train step: 281, reward: 0.0547WARNING: Exploding Gradients 27165.34
train step: 282, reward: 0.0547train step: 283, reward: 0.0547train step: 284, reward: 0.0547train step: 285, reward: 0.0548WARNING: Exploding Gradients 402.93
train step: 286, reward: 0.0547train step: 287, reward: 0.0549train step: 288, reward: 0.0550train step: 289, reward: 0.0550train step: 290, reward: 0.0551train step: 291, reward: 0.0551train step: 292, reward: 0.0551train step: 293, reward: 0.0550train step: 294, reward: 0.0551train step: 295, reward: 0.0550train step: 296, reward: 0.0550train step: 297, reward: 0.0549WARNING: Exploding Gradients 149.37
train step: 298, reward: 0.0548WARNING: Exploding Gradients 347.67
train step: 299, reward: 0.0549train step: 300, reward: 0.0549train step: 301, reward: 0.0550train step: 302, reward: 0.0550train step: 303, reward: 0.0550WARNING: Exploding Gradients 125.70
train step: 304, reward: 0.0550train step: 305, reward: 0.0549WARNING: Exploding Gradients 37736.43
train step: 306, reward: 0.0550WARNING: Exploding Gradients 271.71
train step: 307, reward: 0.0550train step: 308, reward: 0.0549train step: 309, reward: 0.0549train step: 310, reward: 0.0548train step: 311, reward: 0.0547train step: 312, reward: 0.0547train step: 313, reward: 0.0547WARNING: Exploding Gradients 14547.19
train step: 314, reward: 0.0548train step: 315, reward: 0.0549WARNING: Exploding Gradients 336.55
train step: 316, reward: 0.0549WARNING: Exploding Gradients 119.99
train step: 317, reward: 0.0550train step: 318, reward: 0.0550WARNING: Exploding Gradients 371.15
train step: 319, reward: 0.0549train step: 320, reward: 0.0549commands.sh: line 15: 35573 Terminated              CUDA_VISIBLE_DEVICES=1 python3 -u train_full_rl.py --path=tmp/rl_15_5_/ --abs_dir=tmp/abstractor_85_30/ --ext_dir=tmp/extractor_loss_1_0.5/
